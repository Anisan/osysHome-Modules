# Modules - Система управления модулями

![Modules Icon](static/Modules.png)

Комплексная система управления модулями для установки, обновления и управления плагинами из репозиториев GitHub.

## Описание

Модуль `Modules` предоставляет полную систему управления модулями для платформы osysHome. Он позволяет устанавливать модули из GitHub, проверять обновления, обновлять модули и ядро системы, а также управлять жизненным циклом модулей.

## Основные возможности

- ✅ **Установка модулей**: Установка модулей из репозиториев GitHub
- ✅ **Обнаружение обновлений**: Автоматическое обнаружение обновлений модулей
- ✅ **Обновление модулей**: Обновление модулей до последней версии
- ✅ **Обновление ядра**: Обновление ядра системы osysHome
- ✅ **Удаление модулей**: Удаление модулей и очистка таблиц базы данных
- ✅ **Интеграция поиска**: Поиск модулей по имени, заголовку или описанию
- ✅ **Поддержка виджетов**: Виджет панели управления с доступными обновлениями
- ✅ **Циклическая проверка обновлений**: Фоновая задача для проверки обновлений

## Панель администратора

Модуль предоставляет комплексный административный интерфейс:

### Главный вид
- **Список модулей**: Просмотр всех установленных модулей
- **Статус обновлений**: Просмотр модулей с доступными обновлениями
- **Информация о модуле**: Имя, заголовок, описание, версия
- **Действия**: Установка, обновление, удаление модулей

### Операции с модулями

#### Установка модуля
- Установка из репозитория GitHub
- Формат: `osysHome-{module_name}`
- Автоматическая установка зависимостей из `requirements.txt`
- Регистрация в базе данных

#### Обновление модуля
- Обновление до последнего коммита или ветки
- Сохранение конфигурации
- Автоматическое обновление зависимостей
- Уведомление о перезапуске

#### Удаление модуля
- Удаление файлов модуля
- Удаление таблиц базы данных
- Очистка регистраций
- Защищенные модули не могут быть удалены

#### Обновление ядра
- Обновление ядра системы osysHome
- Поддержка выбора ветки
- Обновление до конкретного коммита

## Обнаружение обновлений

Модуль включает циклическую задачу, которая:
- Проверяет GitHub на наличие новых коммитов
- Сравнивает с последней известной датой обновления
- Уведомляет о доступных обновлениях
- Соблюдает лимиты GitHub API
- Поддерживает токен GitHub для увеличения лимитов

### Настройки обновлений
- **Интервал обновлений**: Время между проверками обновлений (по умолчанию: 60 минут)
- **Токен GitHub**: Персональный токен доступа для API (опционально)

## Виджет

Модуль предоставляет виджет панели управления, показывающий:
- Доступные обновления ядра
- Модули с доступными обновлениями
- Визуальные индикаторы обновлений

## Интеграция поиска

Модуль предоставляет функциональность поиска:
- Поиск по имени модуля
- Поиск по заголовку модуля
- Поиск по описанию
- Прямые ссылки на модули

## Защищенные модули

Следующие модули не могут быть удалены:
- `Modules` - Система управления модулями
- `Objects` - Система управления объектами
- `Users` - Управление пользователями
- `Scheduler` - Планировщик задач
- `wsServer` - WebSocket сервер

## Использование

### Установка модуля

1. Перейдите в панель администратора Modules
2. Используйте формат URL установки: `Modules?op=install&name={module}&author={author}`
3. Модуль будет загружен из GitHub
4. Зависимости установлены автоматически
5. Модуль зарегистрирован в базе данных

### Обновление модуля

1. Перейдите в панель администратора Modules
2. Нажмите обновление на модуле с доступным обновлением
3. Выберите коммит (опционально) или используйте последний
4. Файлы модуля обновлены
5. Зависимости обновлены при необходимости
6. Может потребоваться перезапуск системы

### Удаление модуля

1. Перейдите в панель администратора Modules
2. Нажмите удаление на модуле
3. Подтвердите удаление
4. Файлы модуля и таблицы базы данных удалены

## Технические детали

- **Интеграция GitHub**: GitHub API v3
- **Формат репозитория**: `osysHome-{module_name}`
- **Управление зависимостями**: Автоматическая установка pip из requirements.txt
- **Очистка базы данных**: Автоматическое удаление таблиц при удалении
- **Ограничение скорости**: Обработка лимитов GitHub API
- **Многопоточность**: Фоновая проверка обновлений

## Версия

Текущая версия: **1.0**

## Категория

System

## Действия

Модуль предоставляет следующие действия:
- `search` - Поиск модулей по имени, заголовку или описанию
- `cycle` - Фоновая задача для проверки обновлений
- `widget` - Виджет панели управления с информацией об обновлениях

## Требования

- Flask
- SQLAlchemy
- Requests
- Доступ к GitHub API
- Основная система osysHome

## Автор

Eraser

## Лицензия

См. лицензию основного проекта osysHome

